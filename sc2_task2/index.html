
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../sc2_task1/">
      
      
        <link rel="next" href="../sc2_task_3/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.14">
    
    
      
        <title>Task 2 - LTRXAR-2001</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.85bb2934.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#task-2-review-viptela-sd-wan-api-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="LTRXAR-2001" class="md-header__button md-logo" aria-label="LTRXAR-2001" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LTRXAR-2001
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Task 2
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="LTRXAR-2001" class="md-nav__button md-logo" aria-label="LTRXAR-2001" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    LTRXAR-2001
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Lab Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Lab Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        About This Lab
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../env_setup/" class="md-nav__link">
        Environment Setup
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Introduction to Key Concepts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Introduction to Key Concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../key_concepts/" class="md-nav__link">
        Key Concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../temp_exp/" class="md-nav__link">
        Task 1: Template Export(Demonstration)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../temp_dump/" class="md-nav__link">
        Task 2: Template Export(Template Dump)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Scenario 1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Scenario 1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sc_1_desc/" class="md-nav__link">
        Description
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sc1_t1/" class="md-nav__link">
        Task 1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sc1_t2/" class="md-nav__link">
        Task 2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sc1_t3/" class="md-nav__link">
        Task 3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sc1_t4/" class="md-nav__link">
        Task 4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sc1_t5/" class="md-nav__link">
        Task 5
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sc1_t6/" class="md-nav__link">
        Task 6
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sc1_t7/" class="md-nav__link">
        Task 7
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sc1_t8/" class="md-nav__link">
        Task 8
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sc1_recap/" class="md-nav__link">
        Recap
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Scenario 2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Scenario 2
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sc2_desc/" class="md-nav__link">
        Description
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sc2_task1/" class="md-nav__link">
        Task 1
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Task 2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Task 2
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#task-2-review-viptela-sd-wan-api-documentation" class="md-nav__link">
    Task 2: Review Viptela SD-WAN API documentation
  </a>
  
    <nav class="md-nav" aria-label="Task 2: Review Viptela SD-WAN API documentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understand-the-cloud-onramp-for-multicloud-process" class="md-nav__link">
    Understand the Cloud OnRamp for Multicloud Process
  </a>
  
    <nav class="md-nav" aria-label="Understand the Cloud OnRamp for Multicloud Process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#associate-cloud-account" class="md-nav__link">
    Associate Cloud Account
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloud-global-settings" class="md-nav__link">
    Cloud Global Settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-cloud-gateway" class="md-nav__link">
    Create cloud gateway
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manage-intent-via-segmentation-policies" class="md-nav__link">
    Manage intent (via segmentation policies)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sc2_task_3/" class="md-nav__link">
        Task 3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sc2_task4/" class="md-nav__link">
        Task 4
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../sc_2_cont_edu/" class="md-nav__link">
        Continue Your Education
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Appendix
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Appendix
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../appendix/" class="md-nav__link">
        Linux Commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#task-2-review-viptela-sd-wan-api-documentation" class="md-nav__link">
    Task 2: Review Viptela SD-WAN API documentation
  </a>
  
    <nav class="md-nav" aria-label="Task 2: Review Viptela SD-WAN API documentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understand-the-cloud-onramp-for-multicloud-process" class="md-nav__link">
    Understand the Cloud OnRamp for Multicloud Process
  </a>
  
    <nav class="md-nav" aria-label="Understand the Cloud OnRamp for Multicloud Process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#associate-cloud-account" class="md-nav__link">
    Associate Cloud Account
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloud-global-settings" class="md-nav__link">
    Cloud Global Settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-cloud-gateway" class="md-nav__link">
    Create cloud gateway
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manage-intent-via-segmentation-policies" class="md-nav__link">
    Manage intent (via segmentation policies)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Task 2</h1>

<h2 id="task-2-review-viptela-sd-wan-api-documentation">Task 2: Review Viptela SD-WAN API documentation</h2>
<p><a href="https://developer.cisco.com/docs/sdwan/">https://developer.cisco.com/docs/sdwan/</a></p>
<p>Most of the APIs used in this document in the 'multicloud' section.  Before we can leverage ANY of the APIs we need to dig into the authentication section of the API documentation.  This was covered in Section 1, so let’s discuss the APIs used in Section 2.    </p>
<p><strong>REMINDER: </strong></p>
<p>Every data service API request begins with the following Base URI: https://&lt;vmanage-server>/dataservice <br />
We’ll be performing several POST operations using the following APIs:<br />
/multicloud/accounts<br />
/multicloud/settings/global<br />
/multicloud/hostvpc/tags<br />
/multicloud/cloudgateway<br />
/multicloud/map  </p>
<h3 id="understand-the-cloud-onramp-for-multicloud-process">Understand the Cloud OnRamp for Multicloud Process</h3>
<p>A. Associate Cloud account (see variable file that you’ve updated)<br />
B. Cloud Global Settings<br />
C. Create cloud gateway<br />
D. Manage intent (via segmentation policies)  </p>
<p>*<strong>** DON’T Configure any of the steps listed in this section, this is for informational purposes only *</strong>**</p>
<h4 id="associate-cloud-account">Associate Cloud Account</h4>
<p>(Don’t configure this via the GUI, just showing it for visibility)</p>
<p><img alt="Screenshot" src="../img/Picture51.png" /><br />
<img alt="Screenshot" src="../img/Picture52.png" /><br />
<img alt="Screenshot" src="../img/Picture53.png" /><br />
<img alt="Screenshot" src="../img/Picture54.png" /><br />
<img alt="Screenshot" src="../img/Picture55.png" /> </p>
<p>You can see here that the /Multicloud/accounts API is used to associate the cloud account.  You can create and manage cloud accounts and configure global settings in Cisco vManage for AWS automation. You can create multiple accounts, pick a specific account for transit gateway, mark one or more accounts for transit VPC automation and use other accounts for host VPC discovery and connectivity.  </p>
<p>The multicloud dashboard supports AWS key and IAM role models for authentication. IAM roles only work for AWS cloud deployed Cisco vManage, as this requires special AWS AssumeRole functions.  The cloudGatewayEnabled variable enables the account to deploy the cloud gateway solution (C8000v in the transit VPC + TGW).</p>
<h4 id="cloud-global-settings">Cloud Global Settings</h4>
<p>From the SD-WAN API documentation</p>
<p><img alt="Screenshot" src="../img/Picture56.png" />  </p>
<p>Global settings enable you to set a configuration one time and repeat across regions and handle resource management globally (per cloud). The software image and instance size specified are used for instantiation of CSRs in the cloud as part of the cloud gateway.  </p>
<p>Global settings include:<br />
Software image: CSR software image used for creating cloud gateway.  There are two available software types: BYOL (Bring your own license) or PAYG (Pay as you go).  In today’s lab we’ll be using a BYOL image.  Specifically, 17.09.02a will be the software image used.    </p>
<p>AWS Instance Size: CSR instance size used depending upon bandwidth requirements.  </p>
<p>Cloud Gateway Solution: The gateway solution used for AWS cloud. For example, transit gateway with transit VPC.  </p>
<p>IP subnet pool: IP subnet pool used for transit VPC creation across regions. Subnet pool can be customized per cloud gateway using custom settings option, if desired.  </p>
<p>Intra-Tag Communication: Allows or denies communication between the VPCs under the same tag.  </p>
<p>Default Route in Host VPCs: Default routes are automatically added to the main route table of the VPC that points to the transit gateway.  </p>
<p>Full Mesh of Transit VPCs: Setup a full mesh connectivity between TVPCs of cloud gateways in different regions so as to carry site to site traffic (through CSRs) over public cloud backbone.  </p>
<p>Site-to-Site Tunnel Encapsulation Type: The two options are GRE or IPsec  </p>
<p><img alt="Screenshot" src="../img/Picture61.png" />   </p>
<p>Note: The above image depicts the Transit Gateway – VPN based (using TVPC) against Transit Gateway – Connect Based (using TVPC) options.  </p>
<p><a href="https://d1.awsstatic.com/architecture-diagrams/ArchitectureDiagrams/sd-wan-deployment-models-ra.pdf?did=wp_card&amp;trk=wp_card">What’s the difference?  One has IPsec and one has GRE?</a>   As mentioned in the image above, the connect option is the latest capability available (~2 years old).  The choice for IPSec or GRE tunnels depends on customer requirements such as required bandwidth, security, use of public or private IP addresses for the tunnel endpoints.  Regardless, both options allow the SD-WAN to be extended into the transit VPC.  </p>
<p><img alt="Screenshot" src="../img/Picture70.png" /> 
<img alt="Screenshot" src="../img/Picture71.png" /> 
<img alt="Screenshot" src="../img/Picture72.png" />   </p>
<p>Note: As you can see in the screenshot from the API documentation above, the softwareImageId is 17.05.01a-[product ID].  We’ll use ‘Cisco-C8K-17.09.02a-42cb6e93-8d9d-490b-a73c-e3e56077ffd1’ in our request.  Why?  AMI version cannot exceed the vManage version.  Since we’re running 20.9 version of vManage in today’s lab, we’re going to use the 17.09.02a version.    </p>
<p>For today’s lab, we’ll also be using the Transit Gateway – VPN based (using TVPC) cloud gateway solution.</p>
<h4 id="create-cloud-gateway">Create cloud gateway</h4>
<p>AKA, where the magic happens!
This is the step where the TGW &amp; Transit VPC (C8000v devices) are deployed!
What do we need to do in preparation for this step?  </p>
<p>1. Log into your AWS console<br />
2. Go to the AWS Marketplace  </p>
<p><img alt="Screenshot" src="../img/Picture90.png" />  </p>
<p>3. Search for ‘8000v’   </p>
<p><img alt="Screenshot" src="../img/Picture91.png" /> </p>
<p>4. In this lab setup this has already been performed, but a new deployment would require subscribing.  <br />
<strong>(Don’t configure this via the GUI, just showing it for visibility)</strong>  </p>
<p><img alt="Screenshot" src="../img/Picture92.png" /><br />
<img alt="Screenshot" src="../img/Picture93.png" />  </p>
<p>Note: Take note that running EC2/infrastructure cost of running the VMs are NOT free.  Also, the costs differ depending on the selected region.  Select US West and then US East to compare the pricing differences.  </p>
<p>5. Validate permissions-In this lab setup this won’t be an issue, but normal local administrator rights are insufficient.  We specifically need the AmazonEC2FullAccess &amp; AmazonVPCFullAccess permissions associated with the account you supplied for the automation deployment to be successful.  This is configured within the Identity &amp; Access Management (IAM) dashboard to manage access to AWS resources. </p>
<p><img alt="Screenshot" src="../img/Picture94.png" /><br />
<img alt="Screenshot" src="../img/Picture95.png" /></p>
<p>Note: This is a user group called Admins that we’ve associated the privileges to.  You may not have access to IAM as part of this lab but see the above image for demonstration purposes.  Reminder, this is not necessarily a best practice, and you should be following a practice of least privilege and it is common to associate an account specifically for AWS&lt;&gt;vManage interconnect.</p>
<p><strong>(Don’t configure this via the GUI, just showing it for visibility)</strong>  </p>
<p><img alt="Screenshot" src="../img/Picture96.png" />  </p>
<p>Reviewing the screenshot above, we’re going to ignore the settings section as these configurations are already present in our global config.  This settings section is meant to override the global settings, should that be required.  </p>
<p>There is a field that we must populate, the UUID section, which will specify WHICH virtual devices we intent to deploy.  </p>
<p><strong>(Don’t configure this via the GUI, just showing it for visibility)</strong>    </p>
<p><img alt="Screenshot" src="../img/Picture97.png" /></p>
<p>6. Navigate to Configuration&gt;Devices<br />
7. You can see a number of devices with ‘Chassis Number’ in the first column-these are the UUIDs.  Copy/paste two UUIDs into your notepad for the deployment section.  </p>
<p>Note: <strong>Do NOT use the UUID associated with the existing border router.</strong>  </p>
<p><img alt="Screenshot" src="../img/Picture98.png" /></p>
<p>8. Navigate to Configuration&gt;Templates<br />
<strong>(Don’t configure this via the GUI, just showing it for visibility)</strong>   </p>
<p><img alt="Screenshot" src="../img/Picture99.png" />  </p>
<p>9. Navigate to “Device Templates” and take note of the “AWS-cat8kv-multicloud” template.  A normal practice would be to click ‘attach devices’-we’re going to use Ansible for this.<br />
<strong>(Don’t configure this via the GUI, just showing it for visibility)</strong>    </p>
<p><img alt="Screenshot" src="../img/Picture100.png" />  </p>
<p>10.    This template will attach when the device comes online (when we configure the step within the OnRamp for Multicloud Create Cloud Gateway step)</p>
<p><img alt="Screenshot" src="../img/Picture101.png" />  </p>
<h4 id="manage-intent-via-segmentation-policies">Manage intent (via segmentation policies)</h4>
<p>What?  If I keep saying ‘This is where the magic happens’  .. This is where MORE magic happens!  This is where we specifically define which SD-WAN VPNs can reach which AWS VPCs!  Also, we can specify which VPC to VPC traffic we wish to permit.  </p>
<p><img alt="Screenshot" src="../img/Picture110.png" />   </p>
<p>Within the GUI, this is a lot prettier and easier to understand.  </p>
<p><img alt="Screenshot" src="../img/Picture111.png" /> <br />
<img alt="Screenshot" src="../img/Picture112.png" />   </p>
<p>Note: Here you can see that VPN65530 can access the 5StarLab VPC &amp; VPN10 can access the test VPC (bidirectionally).  VPN 10 CANNOT access the 5StarLab VPC.    </p>
<p>Now that we understand the steps, reviewed what variables are needed, and have prepared our AWS environment, we’re ready to get into Ansible!</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../sc2_task1/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Task 1" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Task 1
              </div>
            </div>
          </a>
        
        
          
          <a href="../sc2_task_3/" class="md-footer__link md-footer__link--next" aria-label="Next: Task 3" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Task 3
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "navigation.footer"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  </body>
</html>